<div ng-include="'common/elements/modal/header.html'"></div>
<div class="modal-body">
  <div uib-collapse="!status.loading && !status.done">
    <uib-progress max="form.model.files.length">
      <uib-bar ng-repeat="result in status.results.progressBar track by $index" value="1"
               type="{{::result}}"></uib-bar>
    </uib-progress>
    <p>
      <span ng-show="status.results.success.length > 0" class="text-success">
        <strong ng-show="status.results.error.length == 0 && status.done">All</strong>
        {{status.results.success.length}} computers have been successfully uploaded.
      </span>
      <span ng-show="status.results.error.length > 0" class="text-warning">
        {{status.results.error.length}} computers have <strong>not</strong> been uploaded and require attention. See
        below.
      </span>
    </p>
  </div>
  <form uib-collapse="status.loading || status.done"
        ng-submit="submit(form.model)"
        id="computer-snapshot-form"
        novalidate>
    <formly-form model="form.model" fields="form.fields" form="form.form" options="form.options">
    </formly-form>
  </form>
  <div uib-collapse="status.results.error.length === 0">
    <ul class="list-group">
      <li ng-repeat="result in status.results.error" class="list-group-item">
        <h4 class="list-group-item-heading">{{::result.fileName}}</h4>
        <computer-snapshot-error class="list-group-item-text" status="status" error="result"></computer-snapshot-error>
      </li>
    </ul>
  </div>
</div>
<div class="modal-footer">
  <button type="submit" form="computer-snapshot-form" class="btn btn-primary submit-button"
          ng-disabled="status.loading || status.results.error.length > 0"
          ng-show="!status.done"
          dh-submit-button="status.loading"
  >
    <i class="fa fa-upload"></i>
    Upload
  </button>
  <button ng-show="status.done" class="btn btn-success" type="button" ng-click="restartIfConfirms()">
    <i class="fa fa-plus"></i>
    Upload more Snapshot computers
  </button>
  <button ng-disabled="status.loading" class="btn btn-info" type="button" ng-click="done()">Done</button>
</div>
