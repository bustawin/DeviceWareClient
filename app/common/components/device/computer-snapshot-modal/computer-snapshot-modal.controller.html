<div ng-include="'common/elements/modal/header.html'"></div>
<div class="modal-body">
  <div uib-collapse="!status.working && !status.done">
    <uib-progressbar ng-class="{active: !status.done, 'progress-striped': !status.done}"
                     type="{{progressBarType}}"
                     value="status.uploaded"
                     max="form.model.files.length">
    </uib-progressbar>
    <div ng-show="status.results.error.length > 0 || status.results.success.length > 0" ng-switch="progressBarType">
      <div class="alert alert-warning" ng-switch-when="warning">
        {{status.results.success.length}} computers were successfully uploaded, but
        {{status.results.error.length}} have <strong>not</strong> been uploaded and require attention. See below.
      </div>
      <div class="alert alert-success" ng-switch-when="success">
        All computers ({{status.results.success.length}}) have been successfully uploaded.
      </div>
      <div class="alert alert-danger" ng-switch-when="danger">
        No computer ({{status.results.error.length}}) has been uploaded, see below how to fix it.
      </div>
    </div>
  </div>
  <form uib-collapse="status.working || status.done"
        ng-submit="submit(form.model)"
        id="computer-snapshot-form"
        novalidate>
    <formly-form model="form.model" fields="form.fields" form="form.form" options="form.options">
    </formly-form>
  </form>
  <div uib-collapse="status.results.error.length === 0">
    <ul class="list-group">
      <li ng-repeat="result in status.results.error" class="list-group-item">
        <h4 class="list-group-item-heading">{{::result.fileName}}</h4>
        <computer-snapshot-error class="list-group-item-text" status="status" error="result"></computer-snapshot-error>
      </li>
    </ul>
  </div>
</div>
<div class="modal-footer">
  <button type="submit" form="computer-snapshot-form" class="btn btn-primary submit-button"
          ng-disabled="status.loading || status.results.error.length > 0"
          ng-show="!status.done"
          dh-submit-button="status.loading"
  >
    <i class="fa fa-upload"></i>
    Upload
  </button>
  <button ng-show="status.done" class="btn btn-success" type="button" ng-click="restartIfConfirms()">
    <i class="fa fa-plus"></i>
    Upload more Snapshot computers
  </button>
  <button ng-disabled="status.loading" class="btn btn-info" type="button" ng-click="done()">Done</button>
</div>
